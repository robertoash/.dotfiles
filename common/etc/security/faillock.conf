# Faillock configuration - prevent silent account lockout
#
# Key fix: Remove fail_interval so failures don't accumulate over time windows
# Successful authentication should clear the counter

# Lock after 3 consecutive failures (default, works fine)
deny = 3

# No fail_interval - don't track failures across time windows
# This means 2 failed + 1 successful + 1 failed = only 1 failure in current sequence

# If locked out, unlock after 5 minutes
unlock_time = 300

# CRITICAL: Ensure user gets feedback when locked (explicitly not silent)
# Without this line, silent mode is disabled and user sees "Account locked" messages
