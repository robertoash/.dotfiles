# Passwordless sudo configuration for dotfiles-managed commands
# This file should be installed to /etc/sudoers.d/dotfiles
#
# IMPORTANT: Always test changes with visudo before deploying
# Syntax: username ALL = NOPASSWD: /path/to/command [args]

# Sudo password timeout (in minutes)
# Default is usually 5 or 15 minutes
# 0 = always ask, -1 = never expire (once per boot), N = expire after N minutes
Defaults timestamp_timeout=30

# User-specific passwordless commands
# Replace 'rash' with your username or use %group for group-based rules

# Example: Allow systemctl commands for specific services
# rash ALL = NOPASSWD: /usr/bin/systemctl restart nginx.service
# rash ALL = NOPASSWD: /usr/bin/systemctl start nginx.service
# rash ALL = NOPASSWD: /usr/bin/systemctl stop nginx.service

# Example: Allow package management (use with caution!)
# rash ALL = NOPASSWD: /usr/bin/pacman -Syu
# rash ALL = NOPASSWD: /usr/bin/apt update
# rash ALL = NOPASSWD: /usr/bin/apt upgrade

# Example: Command aliases for better organization
# Cmnd_Alias BACKUP_CMDS = /usr/local/bin/run_bkup_script, /usr/bin/rsync
# rash ALL = NOPASSWD: BACKUP_CMDS

# Add your specific commands below:

# Backup script (already symlinked to /usr/local/bin/)
rash ALL = NOPASSWD: /usr/local/bin/run_bkup_script

# Commands used by setup.py
rash ALL = NOPASSWD: /usr/bin/ln -sf *
rash ALL = NOPASSWD: /usr/bin/tee -a /etc/hosts
rash ALL = NOPASSWD: /usr/bin/visudo -cf *
rash ALL = NOPASSWD: /usr/bin/install -m 0440 *
rash ALL = NOPASSWD: /usr/bin/install -m 0644 *
rash ALL = NOPASSWD: /usr/bin/crontab *
rash ALL = NOPASSWD: /usr/bin/mkdir -p /etc/systemd/resolved.conf.d
rash ALL = NOPASSWD: /usr/bin/tee /etc/systemd/resolved.conf.d/*
rash ALL = NOPASSWD: /usr/bin/systemctl restart systemd-resolved
rash ALL = NOPASSWD: /usr/bin/cp /etc/nftables.conf *
rash ALL = NOPASSWD: /usr/bin/nft -c -f *
rash ALL = NOPASSWD: /usr/bin/nft -f /etc/nftables.conf

# ClamAV database updates (used by topgrade)
rash ALL = NOPASSWD: /usr/bin/freshclam
