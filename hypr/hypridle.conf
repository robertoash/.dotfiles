general {
    lock_cmd = bash -c 'pidof hyprlock || hyprlock'
    after_sleep_cmd = hyprctl dispatch dpms on
    ignore_dbus_inhibit = false
}

# Note: in_office_monitor now runs continuously from launch.conf
# No need to start it here during idle

# Stage 1: 30 seconds - report inactive status
listener {
    timeout = 30
    on-timeout = ~/.config/scripts/ha/activity_status_reporter.py --inactive
    on-resume = ~/.config/scripts/hyprland/idle_simple_resume.py
}

# Stage 2: 50 seconds - face detection check
listener {
    timeout = 50
    on-timeout = ~/.config/scripts/hyprland/presence_detection/face_detector.py
}

# Stage 3: 60 seconds - check in_office and lock if off (respects face detection results)
listener {
    timeout = 60
    on-timeout = ~/.config/scripts/hyprland/idle_simple_lock.py
}

# Stage 4: 90 seconds - check in_office again and dpms off if still off
listener {
    timeout = 90
    on-timeout = ~/.config/scripts/hyprland/idle_simple_dpms.py
}

# Keep the long-term listeners as they are
listener {
    timeout = 7200    # 2 hours in seconds
    on-timeout = /home/rash/.local/bin/cjar puke --sweet
}

listener {
    timeout = 21600    # 6 hours in seconds
    on-timeout = /usr/local/bin/dcli lock
}
